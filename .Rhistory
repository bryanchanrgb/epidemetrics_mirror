FUN = max)
figure_2b_count_max <- plyr::rename(figure_2b_count_max, c("Group.1"="CLASS","n_present"="n_total"))
figure_2b_count <- merge(figure_2b_count,figure_2b_count_max, by="CLASS")
# n_threshold determines where to cut off t_pop xlim values. Only takes t_pop values for which there are >= n_threshold % of the total present for each class
n_threshold = 0.8
figure_2a_count <- subset(figure_2a_count, n_present>=n_threshold*n_total)
figure_2b_count <- subset(figure_2b_count, n_present>=n_threshold*n_total)
t_min = min(figure_2a_count$t_pop, figure_2b_count$t_pop)
t_max = max(figure_2a_count$t_pop, figure_2b_count$t_pop)
# Plot Figure 2 ------------------------------------------------------------
# Set up colour palette
my_palette_1 <- brewer.pal(name="PuOr",n=5)[c(1,2,4,5)]
my_palette_2 <- brewer.pal(name="Oranges",n=4)[4]
label_countries
# Figure 2c: Testing other variables for scatter plot
figure_2c_base <- (ggplot(figure_2c_data, aes(colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5)
# Label countries
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries)),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave")))
figure_2c_loop <- figure_2c_base + geom_point(aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_CONFIRMED_PER_10K) size=1.5,shape=1,alpha=0.9,stroke=1.5)
figure_2c_loop <- figure_2c_base + geom_point(aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_CONFIRMED_PER_10K), size=1.5,shape=1,alpha=0.9,stroke=1.5)
figure_2c_loop
figure_2c_base <- (ggplot(figure_2c_data, aes(colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5)
# Label countries
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries)),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave")))
figure_2c_loop <- figure_2c_base + geom_point(aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_CONFIRMED_PER_10K), size=1.5,shape=1,alpha=0.9,stroke=1.5)
figure_2c_loop
figure_2c_loop <- figure_2c_base + geom_point(aes(x =figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, y =figure_2c_data$EPI_CONFIRMED_PER_10K), size=1.5,shape=1,alpha=0.9,stroke=1.5)
figure_2c_loop
View(figure_2c_data)
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_CONFIRMED_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of cases, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(breaks=seq(0,500,50),expand = c(0,0),limits = c(0, 500))
+ labs(title = "Total Confirmed Cases Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Confirmed Cases per 10,000 Population"))
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_CONFIRMED_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of cases, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(breaks=seq(0,500,50),expand = c(0,0),limits = c(0, 500))
+ labs(title = "Total Confirmed Cases Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Confirmed Cases per 10,000 Population"))
figure_2b_alt <- (ggplot(figure_2b_agg, aes_string(x = "t_pop", y = paste(mobility,".x",sep=""), colour = "CLASS"))
+ geom_line(size=1,show.legend = FALSE,na.rm=TRUE)
+ geom_ribbon(aes_string(ymin=paste(mobility,".x-",mobility,".y",sep=""), ymax=paste(mobility,".x+",mobility,".y",sep=""), fill = "CLASS"), linetype=2, alpha=0.1, show.legend = FALSE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
#+ annotate("text",x=2,y=27,hjust=0,label="T0 (First Day Surpassing Cumulative 5 Cases per Million)",color=my_palette_2)
+ theme_light()
+ coord_cartesian(xlim=c(t_min, t_max))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_x_continuous(breaks=seq(floor(t_min/10)*10,ceiling(t_max/10)*10,10),expand=c(0,0),limits=c(t_min,t_max))
+ scale_y_continuous(expand = c(0,0))
+ labs(title = paste("Average ",mobility," Mobility Over Time",sep=""), x = "Days Since T0", y = paste(mobility," Mobility (Change from Baseline, Smoothed)",sep="")))
figure_2c
ggsave("./plots/figure_2c.png", plot = figure_2c, width = 9,  height = 7)
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_CONFIRMED_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of cases, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log',expand = c(0,0))
+ labs(title = "Total Confirmed Cases Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Confirmed Cases per 10,000 Population"))
ggsave("./plots/figure_2c.png", plot = figure_2c, width = 9,  height = 7)
figure_2c
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of cases, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log10',expand = c(0,0))
+ labs(title = "Total Confirmed Cases Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Confirmed Cases per 10,000 Population"))
ggsave("./plots/figure_2c.png", plot = figure_2c, width = 9,  height = 7)
figure_2c
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of cases, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log',expand = c(0,0))
+ labs(title = "Total Confirmed Cases Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Confirmed Cases per 10,000 Population"))
ggsave("./plots/figure_2c.png", plot = figure_2c, width = 9,  height = 7)
figure_2c
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log',expand = c(0,0), breaks=seq(0.01,0.1,1,10,25,50))
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log',expand = c(0,0))
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log2',expand = c(0,0))
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
figure_2c
# Load Packages, Clear, Sink -------------------------------------------------------
# load packages
package_list <- c("readr","ggplot2","gridExtra","plyr","dplyr","ggsci","RColorBrewer","viridis","sf","reshape2","ggpubr","egg","scales")
for (package in package_list){
if (!package %in% installed.packages()){
install.packages(package)
}
}
lapply(package_list, require, character.only = TRUE)
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log',expand = c(0,0), breaks = log_breaks())
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
figure_2c
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log10',expand = c(0,0), breaks = log_breaks())
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
figure_2c
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log10',expand = c(0,0), breaks = log_breaks(n=10,base=10))
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
figure_2c
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log10', breaks = log_breaks(n=10,base=10),labels = label_number())
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log10', breaks = log_breaks(n=10,base=10,labels = label_number()))
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log10', breaks = log_breaks(n=10,base=10), labels = scales::label_number())
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
?scales::label_number()
?scales::label_comma
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log10', breaks = log_breaks(n=10,base=10), labels = scales::number_format())
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log10', breaks = log_breaks(n=10,base=10), labels = scales::label_numberauto())
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log10', breaks = log_breaks(n=10,base=10), labels = scales::label_number_auto())
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
lsf.str("package:scales")
log_breaks(n=10,base=10)
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log10', breaks = log_breaks(n=10,base=10))
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
ggsave("./plots/figure_2c.png", plot = figure_2c, width = 9,  height = 7)
figure_2c
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log10', breaks = log_breaks(n=10,base=10),labels = scales::number_format())
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
install.packages("scales")
install.packages("scales")
install.packages("scales")
install.packages("scales")
install.packages("scales")
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log10', breaks = log_breaks(n=10,base=10),labels = scales::number_format())
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
package_list <- c("readr","ggplot2","gridExtra","plyr","dplyr","ggsci","RColorBrewer","viridis","sf","reshape2","ggpubr","egg","scales")
for (package in package_list){
if (!package %in% installed.packages()){
install.packages(package)
}
}
lapply(package_list, require, character.only = TRUE)
install.packages(package)
# Figure 2c: Scatter plot of government response time against number of cases for each country
figure_2c <- (ggplot(figure_2c_data, aes(x = GOV_MAX_SI_DAYS_FROM_T0_POP, y = EPI_DEAD_PER_10K, colour = CLASS))
+ geom_point(size=1.5,shape=1,alpha=0.9,stroke=1.5, na.rm=TRUE)
+ geom_vline(xintercept=0,linetype="dashed", color=my_palette_2, size=1)
+ annotate("text",x=2,y=490,hjust=0,label="T0",color=my_palette_2)
# Label countries that have high number of deaths, or early/late government response times
+ geom_text(data=subset(figure_2c_data,
(COUNTRYCODE %in% label_countries) |
(EPI_CONFIRMED_PER_10K >= quantile(figure_2c_data$EPI_CONFIRMED_PER_10K, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP >= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.95,na.rm=TRUE)) |
(GOV_MAX_SI_DAYS_FROM_T0_POP <= quantile(figure_2c_data$GOV_MAX_SI_DAYS_FROM_T0_POP, 0.02,na.rm=TRUE))),
aes(label=COUNTRY),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7))
+ scale_color_manual(values = my_palette_1, name = "Epidemic Wave State", labels = c("Entering First Wave", "Past First Wave", "Entering Second Wave","Past Second Wave"))
+ scale_x_continuous(breaks=seq(-125,200,25),expand = c(0,0),limits = c(-125, 200))
+ scale_y_continuous(trans='log10', breaks = log_breaks(n=10,base=10),labels = scales::number_format())
+ labs(title = "Total Deaths Against Government Response Time", x = "Government Response Time (Days from T0 to Peak of Stringency)", y = "Total Deaths per 10,000 Population"))
