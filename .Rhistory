+ labs(title = "Total Deaths Against Total Government Stringency", x = "Integral Under Stringency Index Curve", y = "Total Deaths per 10000 Population"))
figure_3a
figure_3a <- (ggplot(figure_3a_data, aes(x = si_integral, y = last_dead_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend = FALSE)
+ geom_text(data=subset(figure_3a_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
#(last_dead_per_10k >= quantile(figure_3a_data$last_dead_per_10k, 0.95,na.rm=TRUE)) |
(si_integral >= quantile(figure_3a_data$si_integral, 0.95,na.rm=TRUE)) |
(si_integral <= quantile(figure_3a_data$si_integral, 0.05,na.rm=TRUE))) &
(!country %in% c('United Kingdom','Spain','Eritrea','Cayman Islands','Brazil','Bolivia','South Africa'))),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=3000,y=10,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.85, 0.15))
+ scale_color_manual(values = my_palette_1, name = "Country")
+ scale_x_continuous(expand=expand_scale(mult=c(0.05,0.12)))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.003,0.01,0.03,0.1,0.3,1,3,10), labels=c('0·001','0·003','0·01','0·03','0·1','0·3','1','3','10'))
+ labs(title = "Total Deaths Against Total Government Stringency", x = "Integral Under Stringency Index Curve", y = "Total Deaths per 10000 Population"))
figure_3a
ggsave("./plots/figure_3a.png", plot = figure_3a, width = 9,  height = 7)
figure_3b_wave_1_data$country_highlight = ''
for (c in highlight_countries){
figure_3b_wave_1_data[figure_3b_wave_1_data$country==c,'country_highlight'] <- c
}
figure_3b_wave_1_data$country_highlight <- factor(figure_3b_wave_1_data$country_highlight, levels=c('Australia','Belgium','United States',''))
corr <- cor.test(figure_3b_wave_1_data$dead_during_wave_per_10k, figure_3b_wave_1_data$response_time,
method = "kendall")
p_value_str <- if (corr$p.value<0.0001) {"<0·0001"} else {sub('[.]','·',toString(signif(corr$p.value,2)))}
estimate_str <- sub('[.]','·',toString(signif(corr$estimate,2)))
corr_text <- paste("Kendall's Rank Correlation \nTau Estimate: ",estimate_str," \np-value: ",p_value_str,sep="")
# Plot Figure 3: Scatter plot of government response time against number of cases for each country
figure_3b_wave_1 <- (ggplot(figure_3b_wave_1_data, aes(x = response_time, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE)
+ geom_text(data=subset(figure_3b_wave_1_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(response_time >= quantile(figure_3b_wave_1_data$response_time, 0.8,na.rm=TRUE)) |
(response_time <= quantile(figure_3b_wave_1_data$response_time, 0.02,na.rm=TRUE))) &
!country %in% c('Philippines','Iran','India','Hungary','Turkey','Dominican Republic')),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=1,y=0.01,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_color_manual(values = my_palette_1, name = "Country")
+ scale_x_continuous(trans=pseudolog10_trans, breaks=c(-200,-100,-30,-10,-3,-1,0,1,3,10,30), expand=expand_scale(mult=c(0.05,0.2)))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'))
+ labs(title = "Total Deaths During First Wave Against Government Response Time", x = "Government Response Time (Days from 10th Death to Schools Closing)", y = "Total Deaths During First Wave per 10000 Population"))
figure_3b_wave_1
# Plot Figure 3: Scatter plot of government response time against number of cases for each country
figure_3b_wave_1 <- (ggplot(figure_3b_wave_1_data, aes(x = response_time, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend=FALSE)
+ geom_text(data=subset(figure_3b_wave_1_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(response_time >= quantile(figure_3b_wave_1_data$response_time, 0.8,na.rm=TRUE)) |
(response_time <= quantile(figure_3b_wave_1_data$response_time, 0.02,na.rm=TRUE))) &
!country %in% c('Philippines','Iran','India','Hungary','Turkey','Dominican Republic')),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=1,y=0.01,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_color_manual(values = my_palette_1, name = "Country")
+ scale_x_continuous(trans=pseudolog10_trans, breaks=c(-200,-100,-30,-10,-3,-1,0,1,3,10,30), expand=expand_scale(mult=c(0.05,0.2)))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'))
+ labs(title = "Total Deaths During First Wave Against Government Response Time", x = "Government Response Time (Days from 10th Death to Schools Closing)", y = "Total Deaths During First Wave per 10000 Population"))
figure_3b_wave_1
ggsave("./plots/figure_3b_wave_1.png", plot = figure_3b_wave_1, width = 9,  height = 7)
View(figure_3b_wave_1_data)
# Calculate response time as date to reach threshold - date of T0
figure_3b_wave_1_data$response_time <- figure_3b_wave_1_data$first_date_c3_above_threshold - figure_3b_wave_1_data$t0_10_dead
figure_3b_wave_1_data$response_time = as.numeric(figure_3b_wave_1_data$response_time)
corr <- cor.test(figure_3b_wave_1_data$dead_during_wave_per_10k, figure_3b_wave_1_data$response_time,
method = "kendall")
p_value_str <- if (corr$p.value<0.0001) {"<0·0001"} else {sub('[.]','·',toString(signif(corr$p.value,2)))}
estimate_str <- sub('[.]','·',toString(signif(corr$estimate,2)))
corr_text <- paste("Kendall's Rank Correlation \nTau Estimate: ",estimate_str," \np-value: ",p_value_str,sep="")
corr_text
# Calculate response time as date to reach threshold - date of T0
figure_3b_wave_1_data$response_time <- figure_3b_wave_1_data$first_date_c4_above_threshold - figure_3b_wave_1_data$t0_10_dead
figure_3b_wave_1_data$response_time = as.numeric(figure_3b_wave_1_data$response_time) #ttt
corr <- cor.test(figure_3b_wave_1_data$dead_during_wave_per_10k, figure_3b_wave_1_data$response_time,
method = "kendall")
p_value_str <- if (corr$p.value<0.0001) {"<0·0001"} else {sub('[.]','·',toString(signif(corr$p.value,2)))}
estimate_str <- sub('[.]','·',toString(signif(corr$estimate,2)))
corr_text <- paste("Kendall's Rank Correlation \nTau Estimate: ",estimate_str," \np-value: ",p_value_str,sep="")
corr_text
# Calculate response time as date to reach threshold - date of T0
figure_3b_wave_1_data$response_time <- figure_3b_wave_1_data$first_date_c3_above_threshold - figure_3b_wave_1_data$t0_10_dead
figure_3b_wave_1_data$response_time = as.numeric(figure_3b_wave_1_data$response_time)
corr <- cor.test(figure_3b_wave_1_data$dead_during_wave_per_10k, figure_3b_wave_1_data$response_time,
method = "kendall")
p_value_str <- if (corr$p.value<0.0001) {"<0·0001"} else {sub('[.]','·',toString(signif(corr$p.value,2)))}
estimate_str <- sub('[.]','·',toString(signif(corr$estimate,2)))
corr_text <- paste("Kendall's Rank Correlation \nTau Estimate: ",estimate_str," \np-value: ",p_value_str,sep="")
# Plot Figure 3: Scatter plot of government response time against number of cases for each country
figure_3b_wave_1 <- (ggplot(figure_3b_wave_1_data, aes(x = response_time, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend=FALSE)
+ geom_text(data=subset(figure_3b_wave_1_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(response_time >= quantile(figure_3b_wave_1_data$response_time, 0.8,na.rm=TRUE)) |
(response_time <= quantile(figure_3b_wave_1_data$response_time, 0.02,na.rm=TRUE))) &
!country %in% c('Philippines','Iran','India','Hungary','Turkey','Dominican Republic')),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=1,y=0.01,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_color_manual(values = my_palette_1, name = "Country")
+ scale_x_continuous(trans=pseudolog10_trans, breaks=c(-200,-100,-30,-10,-3,-1,0,1,3,10,30), expand=expand_scale(mult=c(0.05,0.2)))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'))
+ labs(title = "Total Deaths During First Wave Against Government Response Time", x = "Government Response Time (Days from 10th Death to Schools Closing)", y = "Total Deaths During First Wave per 10000 Population"))
figure_3b_wave_1
# Plot Figure 3: Scatter plot of government response time against number of cases for each country
figure_3b_wave_1 <- (ggplot(figure_3b_wave_1_data, aes(x = response_time, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend=FALSE)
+ geom_text(data=subset(figure_3b_wave_1_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(response_time >= quantile(figure_3b_wave_1_data$response_time, 0.8,na.rm=TRUE)) |
(response_time <= quantile(figure_3b_wave_1_data$response_time, 0.02,na.rm=TRUE))) &
!country %in% c()),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=1,y=0.01,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_color_manual(values = my_palette_1, name = "Country")
+ scale_x_continuous(trans=pseudolog10_trans, breaks=c(-200,-100,-30,-10,-3,-1,0,1,3,10,30), expand=expand_scale(mult=c(0.05,0.2)))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'))
+ labs(title = "Total Deaths During First Wave Against Government Response Time", x = "Government Response Time (Days from 10th Death to Cancelling Public Events)", y = "Total Deaths During First Wave per 10000 Population"))
figure_3b_wave_1
ggsave("./plots/figure_3b_wave_1.png", plot = figure_3b_wave_1, width = 9,  height = 7)
# Plot Figure 3: Scatter plot of government response time against number of cases for each country
figure_3b_wave_1 <- (ggplot(figure_3b_wave_1_data, aes(x = response_time, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend=FALSE)
+ geom_text(data=subset(figure_3b_wave_1_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(response_time >= quantile(figure_3b_wave_1_data$response_time, 0.8,na.rm=TRUE)) |
(response_time <= quantile(figure_3b_wave_1_data$response_time, 0.02,na.rm=TRUE))) &
!country %in% c('Iran','Sweden','Malaysia')),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=1,y=0.01,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_color_manual(values = my_palette_1, name = "Country")
+ scale_x_continuous(trans=pseudolog10_trans, breaks=c(-200,-100,-30,-10,-3,-1,0,1,3,10,30), expand=expand_scale(mult=c(0.05,0.2)))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'))
+ labs(title = "Total Deaths During First Wave Against Government Response Time", x = "Government Response Time (Days from 10th Death to Cancelling Public Events)", y = "Total Deaths During First Wave per 10000 Population"))
figure_3b_wave_1
ggsave("./plots/figure_3b_wave_1.png", plot = figure_3b_wave_1, width = 9,  height = 7)
ggsave("./plots/figure_3b_wave_1.pdf", plot = figure_3b_wave_1, width = 9,  height = 7)
figure_3a
ggsave("./plots/figure_3a.png", plot = figure_3a, width = 9,  height = 7)
ggsave("./plots/figure_3a.pdf", plot = figure_3a, width = 9,  height = 7)
View(figure_3c_2_days)
View(figure_3c_2_days)
# Plot figure 3c: number of days to reach tests threshold against total deaths in first wave
plot_data <- merge(figure_3c_wave_1_data, figure_3c_2_days, by=c("countrycode"))
plot_data$t <- as.numeric(plot_data$t)
corr <- cor.test(plot_data$dead_during_wave_per_10k, plot_data$t,
method = "kendall")
p_value_str <- if (corr$p.value<0.0001) {"<0·0001"} else {sub('[.]','·',toString(signif(corr$p.value,2)))}
estimate_str <- sub('[.]','·',toString(signif(corr$estimate,2)))
corr_text <- paste("Kendall's Rank Correlation \nTau Estimate: ",estimate_str," \np-value: ",p_value_str,sep="")
figure_3c_days <- (ggplot(plot_data, aes(x = t, y = dead_during_wave_per_10k))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE)
+ geom_text(data=subset(plot_data,
((countrycode %in% label_countries) |
(t >= quantile(plot_data$t, 0.9,na.rm=TRUE)) |
(t <= quantile(plot_data$t, 0.1,na.rm=TRUE)))),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=50,y=0.02,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'), expand=expand_scale(mult=c(0.05,0.05)))
+ scale_x_continuous(expand=expand_scale(mult=c(0.05,0.05)))
+ labs(title = "Deaths During First Wave Against Early Testing",
x = paste("Days to Reach",tests_threshold,"Tests per 10000 Population (Relative to the Date of the 10th Death)",sep=" "),
y = "Total Deaths During First Wave per 10000 Population"))
figure_3c_days
plot_data$country_highlight = ''
for (c in highlight_countries){
plot_data[plot_data$country==c,'country_highlight'] <- c}
plot_data$country_highlight <- factor(plot_data$country_highlight, levels=c('Australia','Belgium','United States',''))
corr <- cor.test(plot_data$dead_during_wave_per_10k, plot_data$t,
method = "kendall")
p_value_str <- if (corr$p.value<0.0001) {"<0·0001"} else {sub('[.]','·',toString(signif(corr$p.value,2)))}
estimate_str <- sub('[.]','·',toString(signif(corr$estimate,2)))
corr_text <- paste("Kendall's Rank Correlation \nTau Estimate: ",estimate_str," \np-value: ",p_value_str,sep="")
figure_3c_days <- (ggplot(plot_data, aes(x = t, y = dead_during_wave_per_10k))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE)
+ geom_text(data=subset(plot_data,
((countrycode %in% label_countries) |
(t >= quantile(plot_data$t, 0.9,na.rm=TRUE)) |
(t <= quantile(plot_data$t, 0.1,na.rm=TRUE)))),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=50,y=0.02,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'), expand=expand_scale(mult=c(0.05,0.05)))
+ scale_x_continuous(expand=expand_scale(mult=c(0.05,0.05)))
+ labs(title = "Deaths During First Wave Against Early Testing",
x = paste("Days to Reach",tests_threshold,"Tests per 10000 Population (Relative to the Date of the 10th Death)",sep=" "),
y = "Total Deaths During First Wave per 10000 Population"))
figure_3c_days
figure_3c_days <- (ggplot(plot_data, aes(x = t, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend=FALSE)
+ geom_text(data=subset(plot_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(t >= quantile(plot_data$t, 0.9,na.rm=TRUE)) |
(t <= quantile(plot_data$t, 0.1,na.rm=TRUE)))),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=50,y=0.02,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'), expand=expand_scale(mult=c(0.05,0.05)))
+ scale_x_continuous(expand=expand_scale(mult=c(0.05,0.05)))
+ labs(title = "Deaths During First Wave Against Early Testing",
x = paste("Days to Reach",tests_threshold,"Tests per 10000 Population (Relative to the Date of the 10th Death)",sep=" "),
y = "Total Deaths During First Wave per 10000 Population"))
figure_3c_days
figure_3c_days <- (ggplot(plot_data, aes(x = t, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend=FALSE)
+ geom_text(data=subset(plot_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(t >= quantile(plot_data$t, 0.9,na.rm=TRUE)) |
(t <= quantile(plot_data$t, 0.1,na.rm=TRUE)))),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=50,y=0.02,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ scale_color_manual(values = my_palette_1, name = "Country")
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'), expand=expand_scale(mult=c(0.05,0.05)))
+ scale_x_continuous(expand=expand_scale(mult=c(0.05,0.05)))
+ labs(title = "Deaths During First Wave Against Early Testing",
x = paste("Days to Reach",tests_threshold,"Tests per 10000 Population (Relative to the Date of the 10th Death)",sep=" "),
y = "Total Deaths During First Wave per 10000 Population"))
figure_3c_days
ggsave("./plots/figure_3c_days.png", plot = figure_3c_days, width = 9,  height = 7)
figure_3c_total <- (ggplot(plot_data, aes(x = tests_per_10k, y = dead_during_wave_per_10k))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE)
+ geom_text(data=subset(plot_data,
((countrycode %in% label_countries) |
(tests_per_10k >= quantile(plot_data$tests_per_10k, 0.9,na.rm=TRUE)) |
(tests_per_10k <= quantile(plot_data$tests_per_10k, 0.1,na.rm=TRUE))) &
!country %in% c('Mexico','Iran','New Zealand')),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=1500,y=0.02,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_x_continuous(trans='log10', breaks=c(10,30,100,300,1000,3000),labels=c('10','30','100','300','1000','3000'), expand=expand_scale(mult=c(0.05,0.15)))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'), expand=expand_scale(mult=c(0.05,0.05)))
+ labs(title = "Deaths During First Wave Against Total Testing",
x = "Total Tests During First Wave per 10000 Population",
y = "Total Deaths During First Wave per 10000 Population"))
figure_3c_total
figure_3c_days <- (ggplot(plot_data, aes(x = t, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend=FALSE)
+ geom_text(data=subset(plot_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(t >= quantile(plot_data$t, 0.9,na.rm=TRUE)) |
(t <= quantile(plot_data$t, 0.1,na.rm=TRUE))) &
!country %in% c('Mexico','Iran','New Zealand')),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=50,y=0.02,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ scale_color_manual(values = my_palette_1, name = "Country")
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'), expand=expand_scale(mult=c(0.05,0.05)))
+ scale_x_continuous(expand=expand_scale(mult=c(0.05,0.05)))
+ labs(title = "Deaths During First Wave Against Early Testing",
x = paste("Days to Reach",tests_threshold,"Tests per 10000 Population (Relative to the Date of the 10th Death)",sep=" "),
y = "Total Deaths During First Wave per 10000 Population"))
figure_3c_days
# Plot figure 3c: number of days to reach tests threshold against total deaths in first wave
plot_data <- merge(figure_3c_wave_1_data, figure_3c_2_days, by=c("countrycode"))
plot_data$t <- as.numeric(plot_data$t)
plot_data$country_highlight = ''
for (c in highlight_countries){
plot_data[plot_data$country==c,'country_highlight'] <- c}
plot_data$country_highlight <- factor(plot_data$country_highlight, levels=c('Australia','Belgium','United States',''))
corr <- cor.test(plot_data$dead_during_wave_per_10k, plot_data$t,
method = "kendall")
p_value_str <- if (corr$p.value<0.0001) {"<0·0001"} else {sub('[.]','·',toString(signif(corr$p.value,2)))}
estimate_str <- sub('[.]','·',toString(signif(corr$estimate,2)))
corr_text <- paste("Kendall's Rank Correlation \nTau Estimate: ",estimate_str," \np-value: ",p_value_str,sep="")
figure_3c_days <- (ggplot(plot_data, aes(x = t, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend=FALSE)
+ geom_text(data=subset(plot_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(t >= quantile(plot_data$t, 0.9,na.rm=TRUE)) |
(t <= quantile(plot_data$t, 0.1,na.rm=TRUE))) &
!country %in% c('Mexico','Iran','New Zealand')),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=50,y=0.02,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ scale_color_manual(values = my_palette_1, name = "Country")
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'), expand=expand_scale(mult=c(0.05,0.05)))
+ scale_x_continuous(expand=expand_scale(mult=c(0.05,0.05)))
+ labs(title = "Deaths During First Wave Against Early Testing",
x = paste("Days to Reach",tests_threshold,"Tests per 10000 Population (Relative to the Date of the 10th Death)",sep=" "),
y = "Total Deaths During First Wave per 10000 Population"))
figure_3c_days
ggsave("./plots/figure_3c_days.png", plot = figure_3c_days, width = 9,  height = 7)
# Plot figure 3c: total tests against total deaths in first wave
plot_data <- merge(figure_3c_wave_1_data, figure_3c_2_total, by=c("countrycode"))
plot_data$tests_per_10k <- as.numeric(plot_data$tests_per_10k)
plot_data$country_highlight = ''
for (c in highlight_countries){
plot_data[plot_data$country==c,'country_highlight'] <- c}
plot_data$country_highlight <- factor(plot_data$country_highlight, levels=c('Australia','Belgium','United States',''))
corr <- cor.test(plot_data$dead_during_wave_per_10k, plot_data$tests_per_10k,
method = "kendall")
p_value_str <- if (corr$p.value<0.0001) {"<0·0001"} else {sub('[.]','·',toString(signif(corr$p.value,2)))}
estimate_str <- sub('[.]','·',toString(signif(corr$estimate,2)))
corr_text <- paste("Kendall's Rank Correlation \nTau Estimate: ",estimate_str," \np-value: ",p_value_str,sep="")
figure_3c_total <- (ggplot(plot_data, aes(x = tests_per_10k, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend=FALSE)
+ geom_text(data=subset(plot_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(tests_per_10k >= quantile(plot_data$tests_per_10k, 0.9,na.rm=TRUE)) |
(tests_per_10k <= quantile(plot_data$tests_per_10k, 0.1,na.rm=TRUE))) &
!country %in% c()),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=1500,y=0.02,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ scale_color_manual(values = my_palette_1, name = "Country")
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_x_continuous(trans='log10', breaks=c(10,30,100,300,1000,3000),labels=c('10','30','100','300','1000','3000'), expand=expand_scale(mult=c(0.05,0.15)))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'), expand=expand_scale(mult=c(0.05,0.05)))
+ labs(title = "Deaths During First Wave Against Total Testing",
x = "Total Tests During First Wave per 10000 Population",
y = "Total Deaths During First Wave per 10000 Population"))
figure_3c_total
figure_3c_total <- (ggplot(plot_data, aes(x = tests_per_10k, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend=FALSE)
+ geom_text(data=subset(plot_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(tests_per_10k >= quantile(plot_data$tests_per_10k, 0.9,na.rm=TRUE)) |
(tests_per_10k <= quantile(plot_data$tests_per_10k, 0.1,na.rm=TRUE))) &
!country %in% c('South Africa','Madagascar')),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=1500,y=0.02,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ scale_color_manual(values = my_palette_1, name = "Country")
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_x_continuous(trans='log10', breaks=c(10,30,100,300,1000,3000),labels=c('10','30','100','300','1000','3000'), expand=expand_scale(mult=c(0.05,0.15)))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'), expand=expand_scale(mult=c(0.05,0.05)))
+ labs(title = "Deaths During First Wave Against Total Testing",
x = "Total Tests During First Wave per 10000 Population",
y = "Total Deaths During First Wave per 10000 Population"))
figure_3c_total
ggsave("./plots/figure_3c_total.png", plot = figure_3c_total, width = 9,  height = 7)
View(plot_data)
figure_3c_total <- (ggplot(plot_data, aes(x = tests_per_10k, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend=FALSE)
+ geom_text(data=subset(plot_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(tests_per_10k >= quantile(plot_data$tests_per_10k, 0.9,na.rm=TRUE)) |
(tests_per_10k <= quantile(plot_data$tests_per_10k, 0.1,na.rm=TRUE))) &
!country %in% c('South Africa','Madagascar','Côte d''Ivoire','Mozambique')),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=1500,y=0.02,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ scale_color_manual(values = my_palette_1, name = "Country")
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_x_continuous(trans='log10', breaks=c(10,30,100,300,1000,3000),labels=c('10','30','100','300','1000','3000'), expand=expand_scale(mult=c(0.05,0.15)))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'), expand=expand_scale(mult=c(0.05,0.05)))
+ labs(title = "Deaths During First Wave Against Total Testing",
x = "Total Tests During First Wave per 10000 Population",
y = "Total Deaths During First Wave per 10000 Population"))
figure_3c_total <- (ggplot(plot_data, aes(x = tests_per_10k, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend=FALSE)
+ geom_text(data=subset(plot_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(tests_per_10k >= quantile(plot_data$tests_per_10k, 0.9,na.rm=TRUE)) |
(tests_per_10k <= quantile(plot_data$tests_per_10k, 0.1,na.rm=TRUE))) &
!country %in% c('South Africa','Madagascar','Côte d\'Ivoire','Mozambique')),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=1500,y=0.02,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ scale_color_manual(values = my_palette_1, name = "Country")
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_x_continuous(trans='log10', breaks=c(10,30,100,300,1000,3000),labels=c('10','30','100','300','1000','3000'), expand=expand_scale(mult=c(0.05,0.15)))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'), expand=expand_scale(mult=c(0.05,0.05)))
+ labs(title = "Deaths During First Wave Against Total Testing",
x = "Total Tests During First Wave per 10000 Population",
y = "Total Deaths During First Wave per 10000 Population"))
figure_3c_total
figure_3c_total <- (ggplot(plot_data, aes(x = tests_per_10k, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend=FALSE)
+ geom_text(data=subset(plot_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(tests_per_10k >= quantile(plot_data$tests_per_10k, 0.9,na.rm=TRUE)) |
(tests_per_10k <= quantile(plot_data$tests_per_10k, 0.1,na.rm=TRUE))) &
!country %in% c('South Africa','Madagascar','Côte d\'Ivoire','Mozambique','Romania')),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=1500,y=0.02,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ scale_color_manual(values = my_palette_1, name = "Country")
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_x_continuous(trans='log10', breaks=c(10,30,100,300,1000,3000),labels=c('10','30','100','300','1000','3000'), expand=expand_scale(mult=c(0.05,0.15)))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'), expand=expand_scale(mult=c(0.05,0.05)))
+ labs(title = "Deaths During First Wave Against Total Testing",
x = "Total Tests During First Wave per 10000 Population",
y = "Total Deaths During First Wave per 10000 Population"))
figure_3c_total
ggsave("./plots/figure_3c_total.png", plot = figure_3c_total, width = 9,  height = 7)
plot_data <- merge(figure_3c_wave_1_data, figure_3c_2_days, by=c("countrycode"))
plot_data$t <- as.numeric(plot_data$t)
plot_data$country_highlight = ''
for (c in highlight_countries){
plot_data[plot_data$country==c,'country_highlight'] <- c}
plot_data$country_highlight <- factor(plot_data$country_highlight, levels=c('Australia','Belgium','United States',''))
corr <- cor.test(plot_data$dead_during_wave_per_10k, plot_data$t,
method = "kendall")
p_value_str <- if (corr$p.value<0.0001) {"<0·0001"} else {sub('[.]','·',toString(signif(corr$p.value,2)))}
estimate_str <- sub('[.]','·',toString(signif(corr$estimate,2)))
corr_text <- paste("Kendall's Rank Correlation \nTau Estimate: ",estimate_str," \np-value: ",p_value_str,sep="")
figure_3c_days <- (ggplot(plot_data, aes(x = t, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend=FALSE)
+ geom_text(data=subset(plot_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(t >= quantile(plot_data$t, 0.9,na.rm=TRUE)) |
(t <= quantile(plot_data$t, 0.1,na.rm=TRUE))) &
!country %in% c('Mexico','Iran','New Zealand')),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=50,y=0.02,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ scale_color_manual(values = my_palette_1, name = "Country")
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'), expand=expand_scale(mult=c(0.05,0.05)))
+ scale_x_continuous(expand=expand_scale(mult=c(0.05,0.1)))
+ labs(title = "Deaths During First Wave Against Early Testing",
x = paste("Days to Reach",tests_threshold,"Tests per 10000 Population (Relative to the Date of the 10th Death)",sep=" "),
y = "Total Deaths During First Wave per 10000 Population"))
figure_3c_days
ggsave("./plots/figure_3c_days.png", plot = figure_3c_days, width = 9,  height = 7)
figure_3c_days <- (ggplot(plot_data, aes(x = t, y = dead_during_wave_per_10k, color=country_highlight))
+ geom_point(size=2,alpha=0.9, na.rm=TRUE, show.legend=FALSE)
+ geom_text(data=subset(plot_data,
((countrycode %in% label_countries) |
(countrycode %in% highlight_countries) |
(t >= quantile(plot_data$t, 0.9,na.rm=TRUE)) |
(t <= quantile(plot_data$t, 0.1,na.rm=TRUE))) &
!country %in% c('Mexico','Iran','New Zealand','United Arab Emirates')),
aes(label=country),
hjust=-0.1, vjust=-0.1,
show.legend = FALSE)
+ geom_text(aes(x=50,y=0.02,hjust=0,label=corr_text),size=4, hjust=0, color='black')
+ theme_light()
+ scale_color_manual(values = my_palette_1, name = "Country")
+ theme(plot.title=element_text(hjust = 0.5), axis.line=element_line(color="black",size=0.7),axis.ticks=element_line(color="black",size=0.7), legend.position=c(0.6, 0.15))
+ scale_y_continuous(trans='log10', breaks=c(0.001,0.01,0.1,1,10),labels=c('0·001','0·01','0·1','1','10'), expand=expand_scale(mult=c(0.05,0.05)))
+ scale_x_continuous(expand=expand_scale(mult=c(0.05,0.1)))
+ labs(title = "Deaths During First Wave Against Early Testing",
x = paste("Days to Reach",tests_threshold,"Tests per 10000 Population (Relative to the Date of the 10th Death)",sep=" "),
y = "Total Deaths During First Wave per 10000 Population"))
figure_3c_days
ggsave("./plots/figure_3c_days.png", plot = figure_3c_days, width = 9,  height = 7)
ggsave("./plots/figure_3c_days.pdf", plot = figure_3c_days, width = 9,  height = 7)
ggsave("./plots/figure_3c_total.pdf", plot = figure_3c_total, width = 9,  height = 7)
